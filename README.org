#+title: Solar System Dotfiles
#+author: Salvatore Criscione
#+OPTIONS: toc:2

#+begin_example
 ________________
< Hello Dotfiles >
 ----------------
        \   ^__^
         \  (xx)\_______
            (__)\       )\/\
             U ||----w |
                ||     ||
#+end_example

* Table of Contents
:PROPERTIES:
:TOC:      :include all :ignore this
:CONTENTS:
:END:

* Preface
This documentation is related to my personal *OpenSUSE* configuration, designed with a single core principle:

**Minimalism**: minimalistic system, reducing attack surface and maintenance.

#+begin_quote
Warning: This is my personal documentation and is not intended to be fully reproducible or serve as an public usage. Copy it at your own risk..
#+end_quote

I use this configuration in many macchines, which are:
- Deimos: MSI Katana 14bv (Gaming Machine)
- Ceres: Thinkpad X395 (Personal Laptop)
- Luna: Thinkpad T14 (Work Machine)

  All 3 shares the same Dots

** Screenshots

[[./screenshots/1.png]]

[[./screenshots/2.png]]

[[./screenshots/3.png]]

[[./screenshots/4.png]]

[[./screenshots/5.png]]

** KISS
That's my own points, Keep It Simple St.
- I like having full control over my systems.
- I find it annoying the constant need of an online account even to use a File Manager.
- I appreciate and embrace free software.
- I consider myself skilled enough to manage a OS.

* Modules
** System
*** User Dirs
#+begin_src conf :mkdirp yes :tangle configs/user-dirs/user-dirs.dirs
# This file is written by xdg-user-dirs-update
# If you want to change or add directories, just edit the line you're
# interested in. All local changes will be retained on the next run.
# Format is XDG_xxx_DIR="$HOME/yyy", where yyy is a shell-escaped
# homedir-relative path, or XDG_xxx_DIR="/yyy", where /yyy is an
# absolute path. No other format is supported.
#
XDG_DOWNLOAD_DIR="$HOME/Downloads"
XDG_DOCUMENTS_DIR="$HOME/Notes"
XDG_MUSIC_DIR="$HOME/Music"
XDG_PICTURES_DIR="$HOME/Pictures"
XDG_VIDEOS_DIR="$HOME/Vids"
XDG_DESKTOP_DIR="$HOME/Misc"
XDG_PUBLICSHARE_DIR="$HOME/Misc"
XDG_TEMPLATES_DIR="$HOME/Misc"
#+end_src

** Software
*** Wallpaper

#+begin_src bash
  mkdir -p ~/Pictures/Wallpapers
  stow -v -R -d ../assets -t ~/Pictures/Wallpapers Wallpapers
#+end_src

*** Foot

#+BEGIN_SRC toml :mkdirp yes :tangle configs/foot/foot.ini
  [main]
  workers=14
  font=SpaceMono Nerd Font:size=12
  pad=16x16 center
    
  [cursor]
  style=block
  blink=no

  [colors]
  # "Concrete" Background / "Drafting" Text
  background=2E3440
  foreground=D8DEE9

  cursor=2E3440 73ba25  # Dark grey text on Green cursor
  # Normal colors (Nord-ish palette)
  regular0=3B4252  # Black
  regular1=BF616A  # Red
  regular2=73ba25  # Green (OpenSUSE)
  regular3=EBCB8B  # Yellow
  regular4=81A1C1  # Blue
  regular5=B48EAD  # Magenta
  regular6=88C0D0  # Cyan
  regular7=E5E9F0  # White
#+END_SRC

#+BEGIN_SRC toml :mkdirp yes :tangle configs/foot/foot-focus.ini
  [main]
  workers=14
  font=SpaceMono Nerd Font:size=12
  pad=16x16 center
  include=/usr/share/foot/themes/modus-operandi
#+END_SRC

#+begin_src bash
  mkdir -p ~/.config/foot
  stow -v -R -t ~/.config/foot foot
#+end_src

*** Gammastep
#+BEGIN_SRC bash :mkdirp yes :tangle bins/gammastep.sh :tangle-mode (identity #o755)
  #!/usr/bin/env bash

  pid=$(pgrep gammastep)

  if [[ $1 = "toggle" ]]; then
      if pgrep -x "gammastep" > /dev/null; then
  	kill -9 $(pgrep -x "gammastep");
      else
  	gammastep -O 5600  2>/dev/null &
      fi
  fi

  if pgrep -x "gammastep" > /dev/null; then
      echo "Filtered"
  else
      echo "-"
  fi
#+END_SRC

*** Tmux
This is a very basic tmux configuration

#+begin_src conf :mkdirp yes :tangle configs/tmux/.tmux.conf
unbind C-b
set -g prefix C-x
bind C-x send-prefix
set -g mode-keys emacs
set -g status-keys emacs
set -s escape-time 0

set -g mouse on

# Notifying if other windows has activities
setw -g monitor-activity on

# Renumber windows on window close
set -g renumber-windows on

set -g base-index 1
setw -g pane-base-index 1

# Enable mouse control (clickable windows, panes, resizable panes)
set -g mouse on

# split panes using | and -
bind s split-window -h
bind v split-window -v

unbind q
bind q kill-window

unbind '"'
unbind %

# Probably not needed but rather safe than sorry
set -g default-terminal "screen-256color"
set -ag terminal-overrides ",xterm-256color:Tc"


set -g status-position "top"
set -g status-style bg=default,fg=default
set -g status-justify "left"
#+end_src

*** Wofi

#+begin_src css :mkdirp yes :tangle configs/wofi/style.css
 * {
    font-family: "Space Mono", monospace; /* The new font */
    font-size: 14pt;
    font-weight: bold;
}

window {
    background-color: rgba(38, 38, 38, 0.95); /* #262626 with transparency */
    color: #b9b9b9;
    border: 2px solid #98C379; /* Abduction Green border */
    border-radius: 0px; /* Keep it boxy/techy */
}

#input {
    background-color: #1a1a1a;
    color: #D9967D; /* Typing in Sunset Orange */
    border: none;
    border-bottom: 2px solid #585858;
    padding: 8px 12px;
    margin: 10px;
}

#entry {
    padding: 10px;
}

#entry.selected {
    background-color: #98C379; /* Green highlight */
    color: #1a1a1a; /* Dark text on green background */
}
#+end_src

#+begin_src conf :mkdirp yes :tangle configs/wofi/config
  allow_images=false
  allow_markup=false
  anchor=end
  width=752
  height=390
  columns=1
  show=drun
  term=footclient
  hide_scroll=true
  layer=top
  orientation=vertical
  matching=fuzzy
  insensitive=true
  dynamic_lines=true
  no_actions=true
#+end_src

*** Waybar
#+begin_src json :mkdirp yes :tangle configs/waybar/config
  {
  "layer":  "top",
  "position": "bottom",
  "height": 42,
  "spacing": 8,
  "margin": "0 8 8 8",

  "modules-left": ["custom/spacer", "custom/intro", "custom/spacer", "sway/workspaces"],
  "modules-center": [ "sway/mode" ],
  "modules-right": ["cpu", "memory", "battery", "clock" ],

  "custom/spacer": { "format": " " },

  "sway/mode": {
  "format": " {}",
  "max-length": 150
  },

  "custom/intro": {
  "format": "        "
  },

  "cpu": {
  "format": "CPU {usage}%",
  "interval": 5
  },

  "memory": {
  "format": "| MEM {percentage}%",
  "interval": 10
  },

  "battery": {
  "format": "| BAT {capacity}%",
  "interval":  30
  },

  "clock": {
  "format": "| {:%H:%M} ",
  "tooltip-format": "{:%Y-%m-%d | %A}"
  }
  }
#+end_src

#+begin_src css :mkdirp yes :tangle configs/waybar/style.css
 * {
    font-family: "SpaceMono Nerd Font", monospace;
    font-size: 12pt;
    margin: 0;
    padding: 0;
}

#custom-intro {
    font-size: 14pt;
    background-image: url('/home/ssalva/Pictures/Wallpapers/suse.svg');
    background-position: center;
    background-repeat: no-repeat;
    background-size: contain;
}

window#waybar {
    border-top: 3px solid #AFAF87; 
    background: #262626;
}

#workspaces button {
    padding: 0 8px;
    background: transparent;
    color: #7c7c7c;
    border: none;
    border-radius: 0;
}

#workspaces button.focused {
    color: #D9967D;
    background: #171717;
}

#mode {
    color: #98C379;
    font-size: 10pt;
    font-weight: bold;
}

#workspaces button.urgent {
    background: #98C379;
    color: #262626;
}

#cpu, #memory, #battery, #clock {
    padding: 0 6px;
    color: #b9b9b9;
}

#battery.charging {
    color: #98C379;
}

#battery.warning {
    color: #D9967D;
    animation-name: blink;
    animation-duration: 0.5s;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    animation-direction: alternate;
}

#clock {
    color: #f1f1f1;
    padding-right: 8px;
}
#+end_src

*** Fastfetch

#+begin_src json :mkdirp yes :tangle configs/fastfetch/config.jsonc
{
    "$schema": "https://github.com/fastfetch-cli/fastfetch/raw/dev/doc/json_schema.json",
    "logo": {
        "type": "small",
    },
    "display": {
        "constants": [
            "██ "
        ]
    },
    "modules": [
        {
            "key": "{$1}Distro",
            "keyColor": "38;5;210",
            "type": "os"
        },
        {
            "key": "{$1}Kernel",
            "keyColor": "38;5;84",
            "type": "kernel"
        },
        {
            "key": "{$1}Shell",
            "keyColor": "38;5;147",
            "type": "shell"
        },
        {
            "key": "{$1}Packages",
            "keyColor": "38;5;200",
            "type": "packages"
        },
        {
            "key": "{$1}WM",
            "keyColor": "38;5;44",
            "type": "wm"
        },
        {
            "key": "{$1}CPU",
            "keyColor": "38;5;75",
            "type": "cpu"
        },
        {
            "key": "{$1}Memory",
            "keyColor": "38;5;123",
            "type": "memory"
        }
    ]
}
#+end_src

*** Swaylock

#+BEGIN_SRC conf :mkdirp yes :tangle configs/swaylock/config
  image=~/Pictures/Wallpapers/wp.png
  scaling=fill

  font=SpaceMono Nerd Font
#+END_SRC

** Sway

#+begin_src conf :mkdirp yes :tangle configs/sway/config
  # Read `man 5 sway` for a complete reference.
  xwayland disable
  exec dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK

  ### Variables
  font SpaceMono Nerd Font 12
  default_border pixel 3
  default_floating_border pixel 4
  smart_borders off
  hide_edge_borders none
  focus_follows_mouse yes
  gaps inner 30px
  gaps outer -13px
  gaps left -23px

client.focused           #73ba25   #2E3440    #FFFFFF  #73ba25   #73ba25
client.focused_inactive  #4C566A   #2E3440    #D8DEE9  #4C566A   #4C566A
client.unfocused         #242933   #242933    #888888  #242933   #242933
client.urgent            #BF616A   #BF616A    #FFFFFF  #BF616A   #BF616A

  # Logo key. Use Mod1 for Alt.
  set $mod Mod4
  # Home row direction keys, like vim
  set $left h
  set $down j
  set $up k
  set $right l

  # Your preferred application launcher
  set $menu wofi --show drun

  ### Output configuration
  #
  # Default wallpaper (more resolutions are available in /usr/share/backgrounds/sway/)
  output * bg ~/Pictures/Wallpapers/wallhaven-eyx5ol.jpg fill

  # output eDP-1 scale 1.15
  exec foot -s
  # exec swaybg -c 262626
  #
  # Example configuration:
  #
  #   output HDMI-A-1 resolution 1920x1080 position 1920,0
  #
  # You can get the names of your outputs by running: swaymsg -t get_outputs

  ### Idle configuration
  #
  # Example configuration:
  #
  exec swayidle -w \
  timeout 300 'swaylock -f' \
  timeout 600 'swaymsg "output * power off"' resume 'swaymsg "output * power on"' \
  before-sleep 'swaylock -f'

  # This will lock your screen after 300 seconds of inactivity, then turn off
  # your displays after another 300 seconds, and turn your screens back on when
  # resumed. It will also lock your screen before your computer goes to sleep.

  ### Input configuration
  #
  # Example configuration:
  #
  input type:touchpad {
  dwt enabled
  tap enabled
  natural_scroll enabled
  middle_emulation enabled
  }

  input type:keyboard {
  xkb_layout "us"
  }

  #
  # You can also configure each device individually.
  # Read `man 5 sway-input` for more information about this section.

  ### Key bindings
  #
  # Basics:
  #
  # Start a terminal
  bindsym $mod+Return exec footclient
  bindsym $mod+Shift+Return exec foot --config ~/.config/foot/foot-focus.ini

  bindsym $mod+e exec emacsclient -c -a ''

  bindsym $mod+Shift+i exec swaylock -f
  # Kill focused window
  bindsym $mod+q kill

  # Start your launcher
  bindsym $mod+x exec $menu

  # Drag floating windows by holding down $mod and left mouse button.
  # Resize them with right mouse button + $mod.
  # Despite the name, also works for non-floating windows.
  # Change normal to inverse to use left mouse button for resizing and right
  # mouse button for dragging.
  floating_modifier $mod normal

  # Reload the configuration file
  bindsym $mod+Shift+c reload

  # Exit sway (logs you out of your Wayland session)
  bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'
  #
  # Moving around:
  #
  # Move your focus around
  bindsym $mod+$left focus left
  bindsym $mod+$down focus down
  bindsym $mod+$up focus up
  bindsym $mod+$right focus right
  # Or use $mod+[up|down|left|right]
  bindsym $mod+Left focus left
  bindsym $mod+Down focus down
  bindsym $mod+Up focus up
  bindsym $mod+Right focus right

  # Move the focused window with the same, but add Shift
  bindsym $mod+Shift+$left move left
  bindsym $mod+Shift+$down move down
  bindsym $mod+Shift+$up move up
  bindsym $mod+Shift+$right move right
  # Ditto, with arrow keys
  bindsym $mod+Shift+Left move left
  bindsym $mod+Shift+Down move down
  bindsym $mod+Shift+Up move up
  bindsym $mod+Shift+Right move right
  #
  # Workspaces:
  #
  # Switch to workspace
  bindsym $mod+1 workspace number 1
  bindsym $mod+2 workspace number 2
  bindsym $mod+3 workspace number 3
  bindsym $mod+4 workspace number 4
  bindsym $mod+5 workspace number 5
  bindsym $mod+6 workspace number 6
  bindsym $mod+7 workspace number 7
  bindsym $mod+8 workspace number 8
  bindsym $mod+9 workspace number 9
  bindsym $mod+0 workspace number 10
  # Move focused container to workspace
  bindsym $mod+Shift+1 move container to workspace number 1
  bindsym $mod+Shift+2 move container to workspace number 2
  bindsym $mod+Shift+3 move container to workspace number 3
  bindsym $mod+Shift+4 move container to workspace number 4
  bindsym $mod+Shift+5 move container to workspace number 5
  bindsym $mod+Shift+6 move container to workspace number 6
  bindsym $mod+Shift+7 move container to workspace number 7
  bindsym $mod+Shift+8 move container to workspace number 8
  bindsym $mod+Shift+9 move container to workspace number 9
  bindsym $mod+Shift+0 move container to workspace number 10
  # Note: workspaces can have any name you want, not just numbers.
  # We just use 1-10 as the default.
  #
  # Layout stuff:
  #
  # You can "split" the current object of your focus with
  # $mod+b or $mod+v, for horizontal and vertical splits
  # respectively.
  bindsym $mod+b splith
  bindsym $mod+v splitv

  # Switch the current container between different layout styles
  bindsym $mod+s layout stacking
  bindsym $mod+w layout tabbed
  bindsym $mod+t layout toggle split

  # Make the current focus fullscreen
  bindsym $mod+f fullscreen

  # Toggle the current focus between tiling and floating mode
  bindsym $mod+Shift+space floating toggle

  # Swap focus between the tiling area and the floating area
  bindsym $mod+space focus mode_toggle

  # Move focus to the parent container
  bindsym $mod+a focus parent
  #
  # Scratchpad:
  #
  # Sway has a "scratchpad", which is a bag of holding for windows.
  # You can send windows there and get them back later.

  # Move the currently focused window to the scratchpad
  bindsym $mod+Shift+minus move scratchpad

  # Show the next scratchpad window or hide the focused scratchpad window.
  # If there are multiple scratchpad windows, this command cycles through them.
  bindsym $mod+minus scratchpad show
  #
  # Resizing containers:
  #
  mode "resize" {
  # left will shrink the containers width
  # right will grow the containers width
  # up will shrink the containers height
  # down will grow the containers height
  bindsym $left resize shrink width 10px
  bindsym $down resize grow height 10px
  bindsym $up resize shrink height 10px
  bindsym $right resize grow width 10px

  # Ditto, with arrow keys
  bindsym Left resize shrink width 10px
  bindsym Down resize grow height 10px
  bindsym Up resize shrink height 10px
  bindsym Right resize grow width 10px

  # Return to default mode
  bindsym Return mode "default"
  bindsym Escape mode "default"
  }
  bindsym $mod+r mode "resize"
  #
  # Utilities:
  #

  # Special key to take a screenshot with grim
  bindsym Print exec grim


  # Media keys, redefined for wob support
  bindsym --no-warn --locked XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle

  bindsym --no-warn --locked XF86MonBrightnessDown exec brightnessctl -q set 5%- && ( echo $((`brightnessctl get` * 100 / `brightnessctl m`)) > /tmp/wobpipe )
  bindsym --no-warn --locked XF86MonBrightnessUp exec brightnessctl -q set +5% && ( echo $((`brightnessctl get` * 100 / `brightnessctl m`)) > /tmp/wobpipe )

  bindsym --no-warn --locked XF86AudioRaiseVolume exec pamixer --allow-boost -ui 2 && pamixer --get-volume > /tmp/wobpipe
  bindsym --no-warn --locked XF86AudioLowerVolume exec pamixer --allow-boost -ud 2 && pamixer --get-volume > /tmp/wobpipe
  bindsym --no-warn --locked XF86AudioMute exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > /tmp/wobpipe )


  #
  # Status Bar:
  #
  # Read `man 5 sway-bar` for more information about this section.
  bar {
  swaybar_command waybar
  }


  # Screenshot

  # Screenshots
  ## Area selection shortcuts
  set $selected_window swaymsg -t get_tree | jq -r '.. | select(.pid? and .visible?) | .rect | "\(.x),\(.y) \(.width)x\(.height)"' | slurp
  set $focused_window swaymsg -t get_tree | jq -j '.. | select(.type?) | select(.focused).rect | "\(.x),\(.y) \(.width)x\(.height)"'
  set $focused_output swaymsg -t get_outputs | jq -r '.[] | select(.focused) | .name'
  ## Screenshot commands
  ### Full
  set $screenshot_full grim
  set $screenshot_full_clipboard grim - | wl-copy
  ### Selected window
  set $screenshot_selected_window $selected_window | grim -g-
  set $screenshot_selected_window_clipboard $selected_window | grim -g- - | wl-copy
  ### Selected area
  set $screenshot_selected_area slurp | grim -g-
  set $screenshot_selected_area_clipboard slurp | grim -g- - | wl-copy
  ### Focused window
  set $screenshot_focused_window $focused_window | grim -g-
  set $screenshot_focused_window_clipboard $focused_window | grim -g- - | wl-copy
  ### Focused output
  set $screenshot_focused_output grim -o $($focused_output)
  set $screenshot_focused_output_clipboard grim -o $($focused_output) - | wl-copy

  ## Screenshot mode menu
  set $screenshot "Screenshot: (f) full, (s) select window, (a) select area, (w) focused window, (o) focused output [Ctrl+ saves to clipboard]"
  mode $screenshot {
  # Full
  bindsym f exec $screenshot_full; mode "default"
  bindsym Ctrl+f exec $screenshot_full_clipboard; mode "default"
  # Selected window
  bindsym s exec $screenshot_selected_window; mode "default"
  bindsym Ctrl+s exec $screenshot_selected_window_clipboard; mode "default"
  # Selected area
  bindsym a exec $screenshot_selected_area; mode "default"
  bindsym Ctrl+a exec $screenshot_selected_area_clipboard; mode "default"
  # Focused window
  bindsym w exec $screenshot_focused_window; mode "default"
  bindsym Ctrl+w exec $screenshot_focused_window_clipboard; mode "default"
  # Focused output
  bindsym o exec $screenshot_focused_output; mode "default"
  bindsym Ctrl+o exec $screenshot_focused_output_clipboard; mode "default"

  # Exit screenshot mode menu
  bindsym Return mode "default"
  bindsym Escape mode "default"
  bindsym $mod+Print mode "default"
  }
  bindsym $mod+p mode $screenshot

  exec_always {
  systemctl --user import-environment
  gsettings set org.gnome.desktop.interface gtk-theme 'Adwaita-dark'
  gsettings set org.gnome.desktop.interface icon-theme 'Adwaita'
  gsettings set org.gnome.desktop.interface cursor-theme 'Adwaita'
  gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
  rm /tmp/wobpipe
  exec mkfifo /tmp/wobpipe
  tail -f /tmp/wobpipe | wob
  }

  exec /usr/libexec/polkit-gnome-authentication-agent-1

  include /etc/sway/config.d/*
#+end_src
